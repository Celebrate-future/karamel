<div class="container" style="width: 100%;">


    <div class="row" ng-show="landing">

        <div class="col-xs-3 col-sm-3 col-md-3 text-center" >
            <div class="row" ng-show="gs.githubCredentials.email !== ''" ng-click="profileModal()" >
                GitHub Account Details
            </div>   
            <div class ="row text-center">
                <button ng-click="profileModal()" ng-show="gs.githubCredentials.email === ''" class="btn btn-primary"> Login to GitHub</button>
            </div>
            <div class="row">
                <img src="http://gravatar.com/avatar/{{gs.emailHash}}?d=mm" ng-click="profileModal()" id="githubId" style="height: 50px; margin-left: 2px; border: 2px solid white;" class="profile-image img-circle">
            </div>   

            <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 text-right">
                    <label class="text-muted" ng-show="gs.githubCredentials.email != ''">User: </label>
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 text-left">
                    {{gs.githubCredentials.user| limitTo: 20}}
                </div>
            </div>   
            <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 text-right">
                    <label class="text-muted" ng-show="gs.githubCredentials.email != ''">Email: </label> 
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 text-left">
                    {{gs.githubCredentials.email| limitTo: 20}}
                </div>
            </div>   
            <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 text-right">
                    <label ng-click="profileModal()" class="text-muted" ng-show="gs.githubCredentials.email != ''"> Organization: </label> 
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 text-left"> {{gs.org.name| limitTo: 20}}
                </div>
            </div>   
        </div>        

        <div class="col-xs-4 col-sm-4 col-md-4" ng-show="gs.githubCredentials.email != ''">
            <div class="jumbotron text-center jumboNarrow">
                <h2>New Experiment</h2> 
                <div class="row">
                    <div class="form-group">    
                        <button type="button" class="btn btn-primary vcenter" ng-click="experimentFactoryModal()"  tabindex="1">New Repository in GitHub</button>
                    </div>        
                </div>        
            </div>
        </div>        

        <div class="col-xs-4 col-sm-4 col-md-4" ng-show="gs.githubCredentials.email != ''">
            <div class="jumbotron jumboNarrow text-center">
                <h2>Load Experiment</h2> 
                <div class="row">
                    <div class="form-group">
                        <button type="button" class="btn btn-primary vcenter" ng-click="loadExperimentProfile()"  tabindex="1">Open from GitHub</button>
                    </div>        
                </div>        
                <!--                <div class="row">
                                    <div class="col-xs-10 col-sm-10 col-md-10">
                                        <div class="form-group">
                                            <input id="expName" name="user" placeholder="For example, https://github.com/username/experiment" 
                                                   ng-model="experiment.urlGitClone" class="form-control vcenter"
                                                   type="text" tabindex="2">
                                        </div>
                                    </div>
                                    <div class="col-xs-2 col-sm-2 col-md-2">
                                        <div class="form-group">    
                                            <button for="expName" type="button" class="btn btn-primary" ng-click="loadExperiment()" tabindex="3">Load</button>
                                        </div>
                                    </div>
                                </div>-->
            </div>

        </div>
    </div>


    <div class="row col-xs-6 col-sm-12 col-md-12 col-lg-12" ng-show="!landing">


        <form name="uploadExperiment" ng-submit="pushExperiment()" editable-form novalidate="">    

            <div class="row">    

                <span class="col-md-1 col-lg-1"></span>
                <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                    <label class="control-label">Name: </label>
                    <span>{{experiment.githubRepo| limitTo: 32}}{{ gs.repo.name > 32 ? '...' : ''}}</span>     
                </div>
                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-4">
                    <label class="control-label">URL:</label>
                    <span>{{experiment.urlGitClone| limitTo: 64}}{{ gs.repo.sshUrl > 64 ? '...' : ''}}</span>
                </div>
                <div class="btn-group-sm col-xs-2 col-sm-1 col-md-1 col-lg-1" >
                    <button type="button" class="btn" 
                            ng-class="{'btn-warning': status.isModified, 'btn-primary': !status.isModified}"
                            ng-click="pushExperiment($event)">
                        Save<span ng-show="!status.isModified">d</span> <span class="glyphicon" 
                        ng-class="{'glyphicon-thumbs-up': status.isModified, 'glyphicon-thumbs-down': !status.isModified}"/>
                    </button>

                </div>
                <div class="btn-group-sm col-xs-3 col-sm-3 col-md-3 col-lg-1" dropdown is-open="status.isopen">
                    <button type="button" class="btn btn-danger dropdown-toggle"  ng-disabled="disabled" dropdown-toggle >
                        Close or Delete<span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="cmenu">
                        <li><a href="#experiment" ng-click="closeBrowser($event)">Close</a></li>
                        <li><a href="#experiment" ng-click="deleteLocal($event)">Delete from your Computer</a></li>
                        <li><a href="#experiment" ng-click="deleteRepo($event)">Delete from your Computer and GitHub</a></li>
                    </ul>
                </div>

            </div>

            <div class="row form-group" ng-show="!landing">    
                <div class="col-sm-10 col-md-10 col-lg-10">    
                    <span class="col-md-1 col-lg-1"></span>
                    <label for="status.advanced" class="control-label col-xs-2 col-sm-2 col-md-2 col-lg-2">Advanced 
                        <input type="checkbox" id="status.advanced" name="status.advanced" ng-model="status.advanced" tabindex="4">
                    </label>
                    <span class="col-xs-1 col-sm-1 col-md-1 col-lg-1 pull-right text-left" ng-click="toggle()" ng-show="status.advanced">
                        <i class="glyphicon" ng-class="{'glyphicon-chevron-right': status.expanded, 'glyphicon-chevron-down': !status.expanded}"></i>
                    </span>
                </div>
            </div>

            <div class="row form-group col-lg-12" ng-show="status.advanced && !landing">
                <span class="col-md-1 col-lg-1"></span>
                <div class="row form-group col-sm-9 col-md-9 col-lg-9">

                    <accordion close-others="false">
                        <accordion-group is-open="status.userGroup">
                            <accordion-heading> 
                                <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.userGroup, 'glyphicon-chevron-down': !status.userGroup}"></i>Run experiment as Unix user/group
                            </accordion-heading>
                            Username/group that owns the binaries/source-code installed and the experiment scripts and results.
                            <div class="row">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                                    <label class="control-label" for="user">Username
                                        <input name="user" ng-model="experiment.user" class="form-control "
                                               type="text" tabindex="5" required ng-change="status.isModified=true">
                                    </label>
                                </div>
                                <span class="col-xs-1 col-sm-1 col-md-1 col-lg-1"></span>
                                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                                    <label class="control-label" for="group">Group
                                        <input name="group" ng-model="experiment.group" class="form-control "
                                               type="text" tabindex="6" required ng-change="status.isModified=true">
                                    </label>
                                </div>

                            </div>

                        </accordion-group>
                        <accordion-group is-open="status.binaryOpen">
                            <accordion-heading>
                                <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.binaryOpen, 'glyphicon-chevron-down': !status.binaryOpen}"></i>Download Binaries
                            </accordion-heading>
                            <div class="row">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-4 col-sm-8 col-md-8 col-lg-8">
                                    <label for="experimentBinaryUrl" class="control-label">URL for binary that is downloaded and extracted to /usr/local/{{experiment.githubRepo}}. Uses Chef's 'ark' resource. </label>
                                    <input name="experimentBinaryUrl" placeholder="https://dl.dropboxusercontent.com/u/4555798/myExperiment.jar"  class="form-control" ng-model="experiment.urlBinary" type="text" tabindex="7" required ng-change="status.isModified=true" tooltip="Copy the jar or .targ.gz of your program to a location where it can be downloaded from. During development, you can copy your experiment to you local Dropbox public folder. After copying, right-click on the binary and select 'copy public link'. Then paste that link in this text box."  tooltip-trigger="focus" tooltip-placement="right">
                                </div>
                            </div>

                        </accordion-group>
                        <accordion-group is-open="status.sourceOpen">
                            <accordion-heading>
                                <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.sourceOpen, 'glyphicon-chevron-down': !status.sourceOpen}"></i>Clone and Build Source Code 
                            </accordion-heading>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-3 col-sm-9 col-md-9 col-lg-9">
                                    <label for="experimentSourceUrl" class="control-label">GitHub URL </label>
                                    <input name="experimentSourceUrl" placeholder="https://github.com/username/experiment.git"  class="form-control" ng-model="experiment.urlGitClone" type="text" tabindex="8" required ng-change="status.isModified=true" tooltip="You can select a branch by extending the URL to include the branch."  tooltip-trigger="focus" tooltip-placement="right">
                                </div>        
                            </div>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-3 col-sm-9 col-md-9 col-lg-9">    
                                    <label for="mavenCommand" class="control-label">Maven command</label>
                                    <input name="mavenCommand" placeholder="mvn install -DskipTests"  class="form-control" ng-model="experiment.mavenCommand" type="text" tabindex="9" required ng-change="status.isModified=true">
                                </div>        
                            </div>
                        </accordion-group>
                        <accordion-group is-open="status.dependenciesOpen">
                            <accordion-heading>
                                <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.dependenciesOpen, 'glyphicon-chevron-down': !status.dependenciesOpen}"></i>Dependencies 
                            </accordion-heading>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-8 col-sm-11 col-md-11 col-lg-11">    
                                    <label for="dependencies" class="control-label">Comma-separated list of cookentry::recipe that should be executed before this experiment. Generates the Karamelfile.</label>
                                    <input placeholder="hadoop::dn, spark::slave" name="dependencies"  class="form-control" ng-model="experiment.dependencies" type="text" tabindex="10" required ng-change="status.isModified=true">
                                </div>        
                            </div>        
                        </accordion-group>
                        <accordion-group is-open="status.chefOpen" ng-show="status.advanced">
                            <accordion-heading>
                                <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.chefOpen, 'glyphicon-chevron-down': !status.chefOpen}"></i>Experiment Setup with Chef  
                            </accordion-heading>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-4 col-sm-4 col-md-10 col-lg-10">
                                    <label class="text" for="chefCode">This Chef code is executed before the Experiment Code is run.</label>
                                    <textarea id="chefCode" style="width:100%; height:400px; overflow:scroll;" ng-model="experiment.experimentSetupCode" placeholder="Chef code run before the experiments (during install phase)."  tabindex="11" ng-change="status.isModified=true" class="form-control"></textarea>
                                </div>
                            </div>
                        </accordion-group>
                        <!--                        <accordion close-others="false">
                                                    <span class="col-md-1 col-lg-1" ng-show="status.advanced"></span>
                                                    <accordion-group is-open="status.configOpen" ng-show="status.advanced">
                                                        <accordion-heading>
                                                            Configuration <i class="pull-left glyphicon" ng-class="{'glyphicon-chevron-right': status.configOpen, 'glyphicon-chevron-down': !status.configOpen}"></i>
                                                        </accordion-heading>
                        
                                                        <div class="row form-group">
                                                            <span class="col-md-1 col-lg-1"></span>
                                                            <div class="col-xs-4 col-sm-4 col-md-10 col-lg-10">
                                                                <div class="col-xs-4 col-sm-4 col-md-8 col-lg-8">
                                                                <label for="configFile" class="text">Config File</label>
                                                                <textarea id="configFile" style="width:100%; float:left; height:400px; overflow:scroll;" ng-model="experiment.defaultAttributes" placeholder="key = value  (line-separated for every key-value pair)"  tabindex="10"  class="form-control"></textarea>
                                                            </div>
                                                        </div>
                                                    </accordion-group>-->

                    </accordion>
                </div>
            </div>
            <br/>



            <div class="row form-group col-lg-12" ng-show="!landing">
                <span class="col-md-1 col-lg-1"></span>
                <div class="row form-group col-md-9 col-lg-9">
                    <accordion close-others="false">
                        <accordion-group is-open="$scope.status.experiment[$index].status" ng-repeat="exp in experiment.code">
                            <accordion-heading>
                                <span class="col-xs-1 col-sm-1 col-md-1 col-lg-1 pull-left" ng-click="$scope.status.experiment[$index].status = !$scope.status.experiment[$index].status">
                                    <i class="glyphicon" ng-class="{'glyphicon-chevron-right': $scope.status.experiment[$index].status, 'glyphicon-chevron-down': !$scope.status.experiment[$index].status}"></i>
                                </span>
                                <span class="col-md-4 col-lg-4">Experiment {{$index+1}}: {{exp.name}}</span>
                                <span class="col-xs-1 col-sm-1 col-md-1 col-lg-1 text-center pull-right" 
                                      ng-click="removeExperiment(exp.name)">
                                    <i class="glyphicon glyphicon-minus"></i>
                                </span>
                                <br/> 
                            </accordion-heading>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2">
                                    <select ng-model="exp.scriptType" 
                                            ng-init="exp.scriptType = exp.scriptType || options[0].value"
                                            ng-options="option.value as option.name for option in options"
                                            ng-change="status.isModified=true"
                                            >
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-4 col-sm-8 col-md-10 col-lg-10">
                                    <textarea id="experimentScript" style="width:100%; float:left; height:400px; overflow:scroll;" ng-model="exp.scriptContents" placeholder="Enter the experiment code."  tabindex="13" ng-change="status.isModified=true" class="form-control"></textarea>
                                </div>
                            </div>
                            <br/>
                            <div class="row form-group" ng-show="status.advanced">
                                <span class="col-md-1 col-lg-1"></span>
                                <div class="col-xs-3 col-sm-4 col-md-10 col-lg-10">
                                    <div class="form-group">
                                        <label>Relative path to config file</label>
                                        <input type="text"ng-model="exp.configFileName" placeholder="conf/config.props"  class="form-control" ng-change="status.isModified=true">
                                    </div>
                                    <div class="row form-group" ng-show="exp.configFileName.length > 0">
                                        <span class="col-md-1 col-lg-1"></span>
                                        <label>Configuration File for Experiment</label>
                                        <!--                                        <span class="col-xs-1 col-sm-1 col-md-1 col-lg-1 pull-right" ng-click="removeConfigFile(exp.name)">
                                                                                    <i class="glyphicon glyphicon-minus"></i>
                                                                                </span>-->
                                        <div class="col-xs-4 col-sm-4 col-md-10 col-lg-10">
                                            <textarea id="configFile" style="width:100%; float:left; height:400px; overflow:scroll;" ng-model="exp.configFileContents" placeholder="key = value  (line-separated for every key-value pair)"  tabindex="14" ng-change="status.isModified=true" class="form-control"></textarea>
                                        </div>
                                    </div>
                                </div>
                        </accordion-group>
                    </accordion>              
                </div>    
            </div>
    </div>

</form>

<div class ="row" ng-show="!landing && status.advanced">
    <span class="col-md-1 col-lg-1"></span>

    <div class ="row col-xs-2 col-sm-6 col-md-6 col-lg-6">

        <div class="form-group">
            <label  style="margin-left: 10px">Add Experiment Script</label>
            <input ng-model="newExperimentName" class="form-control" type="text" tabindex="12" placeholder="Name of new experiment script" tooltip="Don't forget to select the type of experiment as either bash or python."  tooltip-trigger="focus" tooltip-placement="right" >
            <button style="margin-left: 10px; margin-top: 10px" ng-click="newExperiment($event)" class="btn btn-default">Add</button>
        </div>        
    </div>        
    <div class ="row" ng-show="newExperimentErr">
        <span class="col-md-1 col-lg-1 text-warning"></span>
        {{newExperimentErMsg}}
    </div>        
</div>        
<br/>

<br/>
</div>
</div>